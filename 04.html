<!DOCTYPE html>
<html lang="ug" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø¨Ù‰Ù„Ù‰Ùƒ ØªÛ•ØªÙ‚Ù‰Ù‚Ø§Øª Ù…Û•Ø±ÙƒÙ‰Ø²Ù‰ - Ø³Û‡Ø¦Ø§Ù„-Ø¬Ø§Û‹Ø§Ø¨ Ú†Û•Ù…Ø¨Ù‰Ø±Ù‰</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    @font-face {
      font-family: 'UKIJ Tuz Tom';
      src: url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap');
    }
    body {
      font-family: 'UKIJ Tuz Tom', 'Noto Sans Arabic', sans-serif;
    }
    .wheel-container {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }
    .wheel-center {
      position: absolute;
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 10;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .wheel-center:after {
      content: '';
      width: 20px;
      height: 20px;
      background: sky-500;
      border-radius: 50%;
    }
    canvas {
      transition: transform 4s cubic-bezier(0.17, 0.67, 0.12, 0.99);
      transform-origin: center;
    }
    .question-item {
      animation: fadeIn 0.5s ease-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    /* SweetAlert Custom Styles */
    .swal2-html-container {
      text-align: right !important;
    }
    .answer-box {
      background-color: #f0fdf4;
      border: 1px solid #86efac;
      color: #166534;
      padding: 15px;
      border-radius: 8px;
      margin-top: 15px;
      display: none;
      animation: fadeIn 0.3s;
    }
  </style>
</head>
<body class="bg-gradient-to-b from-sky-50 to-white min-h-screen flex flex-col">
<header class="bg-sky-600 text-white py-6 shadow-lg">
  <div class="container mx-auto px-4">
    <h1 class="text-3xl font-bold text-center">Ø¨Ù‰Ù„Ù‰Ùƒ ØªÛ•ØªÙ‚Ù‰Ù‚Ø§Øª Ù…Û•Ø±ÙƒÙ‰Ø²Ù‰ - Ø³Û‡Ø¦Ø§Ù„-Ø¬Ø§Û‹Ø§Ø¨ Ú†Û•Ù…Ø¨Ù‰Ø±Ù‰</h1>
  </div>
</header>

<main class="flex-grow container mx-auto px-4 py-8">
  <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-md overflow-hidden p-6 mb-8">

    <!-- Input Section -->
    <div id="questionForm" class="mb-8 bg-sky-50 p-6 rounded-xl border border-sky-100">
      <h3 class="text-lg font-bold text-sky-800 mb-4">ÙŠÛÚ­Ù‰ Ø³Û‡Ø¦Ø§Ù„ Ù‚ÙˆØ´Û‡Ø´</h3>
      <div class="flex flex-col md:flex-row gap-4 mb-4">
        <input
                type="text"
                id="questionInput"
                placeholder="Ø³Û‡Ø¦Ø§Ù„Ù†Ù‰ ÙƒÙ‰Ø±Ú¯ÛˆØ²ÛˆÚ­..."
                class="flex-grow-[2] px-4 py-3 rounded-lg border border-sky-300 focus:border-sky-500 focus:ring-2 focus:ring-sky-200 outline-none text-lg"
        >
        <input
                type="text"
                id="answerInput"
                placeholder="Ø¬Ø§Û‹Ø§Ø¨Ù‰Ù†Ù‰ ÙƒÙ‰Ø±Ú¯ÛˆØ²ÛˆÚ­ (ØªØ§Ù„Ù„Ø§Ø´)"
                class="flex-grow-[1] px-4 py-3 rounded-lg border border-sky-300 focus:border-sky-500 focus:ring-2 focus:ring-sky-200 outline-none text-lg"
        >
      </div>
      <button
              onclick="addQuestion()"
              class="w-full px-6 py-3 bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg transition-colors duration-300 flex items-center justify-center gap-2 shadow-sm"
      >
        <i data-feather="plus-circle"></i>
        ØªÙ‰Ø²Ù‰Ù…Ù„Ù‰ÙƒÙƒÛ• Ù‚ÙˆØ´Û‡Ø´
      </button>

      <!-- Action Buttons -->
      <div class="mt-6 flex flex-wrap gap-3 justify-center border-t pt-6 border-sky-200">
        <button
                onclick="loadQuestionsFromJSON()"
                class="px-5 py-2 bg-amber-500 hover:bg-amber-600 text-white rounded-lg transition-colors flex items-center gap-2 text-sm"
        >
          <i data-feather="upload"></i>
          JSON ÙŠÛˆÙƒÙ„Û•Ø´
        </button>
        <button
                onclick="saveQuestionsToJSON()"
                class="px-5 py-2 bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg transition-colors flex items-center gap-2 text-sm"
        >
          <i data-feather="download"></i>
          JSON Ø³Ø§Ù‚Ù„Ø§Ø´
        </button>
        <button
                onclick="clearAllQuestions()"
                class="px-5 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors flex items-center gap-2 text-sm"
        >
          <i data-feather="trash"></i>
          Ú¾Û•Ù…Ù…Ù‰Ù†Ù‰ Ø¦Û†Ú†ÛˆØ±ÛˆØ´
        </button>
      </div>
    </div>

    <!-- Wheel Section -->
    <div class="flex flex-col items-center">
      <button
              onclick="spinWheel()"
              id="spinButton"
              class="mb-6 px-10 py-4 bg-emerald-500 hover:bg-emerald-600 text-white text-xl font-bold rounded-full transition-all duration-300 flex items-center gap-2 shadow-lg hover:shadow-xl transform hover:scale-105"
      >
        <i data-feather="rotate-cw"></i>
        Ú†Û•Ù…Ø¨Û•Ø±Ù†Ù‰ Ø¦Ø§ÙŠÙ„Ø§Ù†Ø¯Û‡Ø±Û‡Ø´
      </button>

      <div class="wheel-container mb-8">
        <canvas id="wheelCanvas" width="500" height="500" class="mx-auto"></canvas>
        <div class="wheel-center"></div>
      </div>
    </div>

    <!-- List Section -->
    <div id="questionsList" class="mt-8 space-y-3">
      <div class="flex justify-between items-center border-b pb-2 mb-4">
        <h3 class="text-xl font-semibold text-sky-700">Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø± ØªÙ‰Ø²Ù‰Ù…Ù‰ (<span id="questionCount">0</span>)</h3>
      </div>
      <div id="questionItems" class="grid grid-cols-1 gap-2 max-h-96 overflow-y-auto pr-2"></div>
    </div>
  </div>
</main>

<footer class="bg-sky-800 text-white py-6 mt-12">
  <div class="container mx-auto px-4 text-center">
    <p class="text-lg">Ø¨Ù‰Ù„Ù‰Ùƒ ØªÛ•ØªÙ‚Ù‰Ù‚Ø§Øª Ù…Û•Ø±ÙƒÙ‰Ø²Ù‰</p>
    <p class="text-sm opacity-80 mt-2">Â© 2025 - Ø¨Ø§Ø±Ù„Ù‰Ù‚ Ú¾ÙˆÙ‚Û‡Ù‚ Ù‚ÙˆØºØ¯Ù‰Ù„Ù‰Ø¯Û‡</p>
  </div>
</footer>

<!-- SweetAlert2 -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  feather.replace();
  const canvas = document.getElementById("wheelCanvas");
  const ctx = canvas.getContext("2d");

  // Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø± Ø³Ø§Ù†Ù„Ù‰Ù‚ Ù…Û•Ù„Û‡Ù…Ø§ØªÙ‰: { q: "Ø³Û‡Ø¦Ø§Ù„", a: "Ø¬Ø§Û‹Ø§Ø¨" }
  let questions = [];

  let angle = 0;
  let spinning = false;

  // Ø¦Û•Ø³Ù„Ù‰ Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ ÙŠÛˆÙƒÙ„Û•Ø´
  function loadInitialQuestions() {
    const savedData = localStorage.getItem('savedQuestions_v2');
    if (savedData) {
      try {
        questions = JSON.parse(savedData);
      } catch (e) {
        console.error("Ø³Ø§Ù‚Ù„Ø§Ù†ØºØ§Ù† Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ ÙŠÛˆÙƒÙ„Û•Ø´ØªÛ• Ø®Ø§ØªØ§Ù„Ù‰Ù‚:", e);
      }
    } else {
      // ÙƒÙˆÙ†Ø§ Ù†Û•Ø´Ù‰Ø±Ø¯Ù‰ÙƒÙ‰ Ø³Ø§Ù†Ù„Ù‰Ù‚ Ù…Û•Ù„Û‡Ù…Ø§ØªÙ†Ù‰ ØªÛ•ÙƒØ´ÛˆØ±ÛˆØ´
      const oldData = localStorage.getItem('savedQuestions');
      if (oldData) {
        try {
          const oldArr = JSON.parse(oldData);
          // ÙƒÙˆÙ†Ø§ Ø³Ù‰Ø²Ù‰Ù… (String) Ù†Ù‰ ÙŠÛÚ­Ù‰ Ø¦ÙˆØ¨ÙŠÛÙƒØª (Object) Ù‚Ø§ Ø¦Ø§ÙŠÙ„Ø§Ù†Ø¯Û‡Ø±Û‡Ø´
          questions = oldArr.map(q => ({ q: q, a: "" }));
          saveQuestionsToLocalStorage();
        } catch(e) {}
      }
    }
    updateQuestionList();
    drawWheel();
  }

  function updateQuestionList() {
    const container = document.getElementById('questionItems');
    const countElement = document.getElementById('questionCount');
    container.innerHTML = '';

    questions.forEach((item, i) => {
      const div = document.createElement('div');
      div.className = 'question-item bg-gray-50 hover:bg-sky-50 p-3 rounded-lg flex justify-between items-center border border-gray-200';
      div.innerHTML = `
          <div class="flex flex-col">
            <span class="font-bold text-gray-800">${i+1}. ${item.q}</span>
            ${item.a ? `<span class="text-xs text-gray-500 mt-1">Ø¬Ø§Û‹Ø§Ø¨: ${item.a}</span>` : ''}
          </div>
          <button onclick="removeQuestion(${i})" class="text-red-400 hover:text-red-600 p-2" title="Ø¦Û†Ú†ÛˆØ±ÛˆØ´">
            <i data-feather="x-circle" class="w-5 h-5"></i>
          </button>
        `;
      container.appendChild(div);
    });

    countElement.textContent = questions.length;
    feather.replace();

    // Canvas Ú†ÙˆÚ­Ù„Û‡Ù‚Ù‰Ù†Ù‰ ØªÛ•Ú­Ø´Û•Ø´
    if (window.innerWidth < 500) {
      canvas.width = 300;
      canvas.height = 300;
    } else {
      canvas.width = 500;
      canvas.height = 500;
    }
  }

  function addQuestion() {
    const qInput = document.getElementById("questionInput");
    const aInput = document.getElementById("answerInput");
    const q = qInput.value.trim();
    const a = aInput.value.trim();

    if (q) {
      // Ø³Ø§Ù† Ú†Û•ÙƒÙ„Ù‰Ù…Ù‰Ø³Ù‰ Ø¦ÛÙ„Ù‰Û‹ÛØªÙ‰Ù„Ø¯Ù‰
      questions.push({ q: q, a: a });
      qInput.value = "";
      aInput.value = "";
      updateQuestionList();
      drawWheel();
      saveQuestionsToLocalStorage();
    } else {
      Swal.fire({
        title: 'Ø¦Û•Ø³ÙƒÛ•Ø±ØªÙ‰Ø´',
        text: 'Ø³Û‡Ø¦Ø§Ù„ Ù…Û•Ø²Ù…Û‡Ù†Ù‰ Ù‚Û‡Ø±Û‡Ù‚ Ø¨ÙˆÙ„Ù…Ù‰Ø³Û‡Ù†',
        icon: 'warning',
        confirmButtonText: 'Ù…Ø§Ù‚Û‡Ù„'
      });
    }
  }

  function removeQuestion(index) {
    questions.splice(index, 1);
    updateQuestionList();
    drawWheel();
    saveQuestionsToLocalStorage();
  }

  function clearAllQuestions() {
    if(questions.length === 0) return;
    Swal.fire({
      title: 'Ø±Ø§Ø³ØªÙ„Ø§ Ú¾Û•Ù…Ù…Ù‰Ù†Ù‰ Ø¦Û†Ú†ÛˆØ±Û•Ù…Ø³Ù‰Ø²ØŸ',
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#3085d6',
      confirmButtonText: 'Ú¾Û•Ø¦Û•ØŒ Ø¦Û†Ú†ÛˆØ±',
      cancelButtonText: 'ÙŠØ§Ù‚'
    }).then((result) => {
      if (result.isConfirmed) {
        questions = [];
        updateQuestionList();
        drawWheel();
        saveQuestionsToLocalStorage();
        Swal.fire('Ø¦Û†Ú†ÛˆØ±ÛˆÙ„Ø¯Ù‰!', 'Ú¾Û•Ù…Ù…Û• Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø± ØªØ§Ø²Ù‰Ù„Ø§Ù†Ø¯Ù‰.', 'success');
      }
    });
  }

  function drawWheel() {
    if (questions.length === 0) {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      return;
    }

    const radius = canvas.width / 2;
    const slice = (2 * Math.PI) / questions.length;
    const textRadius = radius - 40;

    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Ø®Û•Øª Ú†ÙˆÚ­Ù„Û‡Ù‚Ù‰Ù†Ù‰ Ø³Û‡Ø¦Ø§Ù„ Ø³Ø§Ù†Ù‰ØºØ§ Ù‚Ø§Ø±Ø§Ù¾ ØªÛ•Ú­Ø´Û•Ø´
    let fontSize = Math.max(10, Math.min(18, 80/questions.length));
    // Ø¦Û•Ú¯Û•Ø± 60 ØªÙ‰Ù† Ø¬Ù‰Ù‚ Ø³Û‡Ø¦Ø§Ù„ Ø¨ÙˆÙ„Ø³Ø§ Ø®Û•ØªÙ†Ù‰ ÙŠØ§Ø²Ù…Ø§ÙŠ Ø±Û•Ú­Ú¯Ù‰Ù†Ù‰Ù„Ø§ Ú†Ù‰Ù‚Ù‰Ø±Ù‰Ø´ ÙŠØ§ÙƒÙ‰ Ø¨Û•Ùƒ ÙƒÙ‰Ú†Ù‰ÙƒÙ„Ù‰ØªÙ‰Ø´
    if (questions.length > 60) fontSize = 0;

    ctx.font = `bold ${fontSize}px 'UKIJ Tuz Tom', 'Noto Sans Arabic', sans-serif`;
    ctx.textAlign = "center";

    questions.forEach((item, i) => {
      const start = i * slice;
      const end = start + slice;

      // Ø¨Û†Ù„Û•ÙƒÙ„Û•Ø±Ù†Ù‰ Ø³Ù‰Ø²Ù‰Ø´
      ctx.beginPath();
      ctx.moveTo(radius, radius);
      ctx.arc(radius, radius, radius, start, end);
      ctx.closePath();
      // Ø±Û•Ú­Ù†Ù‰ Ø¦Ø§Ù¾ØªÙˆÙ…Ø§ØªÙ‰Ùƒ Ú¾Ø§Ø³Ù‰Ù„ Ù‚Ù‰Ù„Ù‰Ø´
      ctx.fillStyle = `hsl(${i * (360 / questions.length)}, 70%, 60%)`;
      ctx.fill();
      ctx.strokeStyle = 'white';
      ctx.lineWidth = questions.length > 50 ? 0.5 : 2;
      ctx.stroke();

      // Ø®Û•Øª ÙŠÛØ²Ù‰Ø´ (Ø¦Û•Ú¯Û•Ø± Ø®Û•Øª Ú†ÙˆÚ­Ù„Û‡Ù‚Ù‰ 0 Ø¨ÙˆÙ„Ù…Ù‰Ø³Ø§)
      if (fontSize > 0) {
        ctx.save();
        ctx.translate(radius, radius);
        ctx.rotate(start + slice / 2);
        ctx.textBaseline = "middle";
        ctx.fillStyle = "#fff";

        const text = item.q;
        // Ø¦Û‡Ø²Û‡Ù† Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ Ù‚Ù‰Ø³Ù‚Ø§Ø±ØªÙ‰Ù¾ ÙƒÛ†Ø±Ø³Ù‰ØªÙ‰Ø´
        const displayText = text.length > 15 ? text.substring(0, 15) + '..' : text;
        ctx.fillText(displayText, textRadius, 0);

        ctx.restore();
      }
    });

    // Ø¦ÙˆØªØªÛ‡Ø±Ù‰Ø¯Ù‰ÙƒÙ‰ Ú†Û•Ù…Ø¨Û•Ø±
    ctx.beginPath();
    ctx.arc(radius, radius, 15, 0, Math.PI * 2);
    ctx.fillStyle = 'white';
    ctx.fill();
    ctx.strokeStyle = '#ddd';
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  function spinWheel() {
    if (spinning || questions.length === 0) {
      if(questions.length === 0) alert("Ø¦Ø§Û‹Û‹Ø§Ù„ Ø³Û‡Ø¦Ø§Ù„ Ù‚ÙˆØ´Û‡Ú­!");
      return;
    }
    spinning = true;
    document.getElementById('spinButton').disabled = true;
    document.getElementById('spinButton').classList.add('opacity-50', 'cursor-not-allowed');

    let spinTime = 3000 + Math.random() * 2000;
    let spinAngle = Math.random() * 1080 + 1440;
    let targetAngle = angle + spinAngle;
    let start = null;

    function animate(timestamp) {
      if (!start) start = timestamp;
      let progress = timestamp - start;
      let current = easeOut(progress, angle, spinAngle, spinTime);
      drawRotation(current);

      if (progress < spinTime) {
        requestAnimationFrame(animate);
      } else {
        angle = targetAngle % 360;
        spinning = false;
        const btn = document.getElementById('spinButton');
        btn.disabled = false;
        btn.classList.remove('opacity-50', 'cursor-not-allowed');
        pickQuestion();
      }
    }
    requestAnimationFrame(animate);
  }

  function drawRotation(rotation) {
    const radius = canvas.width / 2;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    ctx.translate(radius, radius);
    ctx.rotate((rotation * Math.PI) / 180);
    ctx.translate(-radius, -radius);
    drawWheel();
    ctx.restore();
  }

  function pickQuestion() {
    if (questions.length === 0) return;

    const slice = 360 / questions.length;
    const index = Math.floor(((360 - angle % 360) % 360) / slice);
    const selected = questions[index];

    setTimeout(() => {
      // SweetAlert Ø¨Ù‰Ù„Û•Ù† Ù…Û‡Ø±Û•ÙƒÙƒÛ•Ù¾ ÙƒÛ†Ø²Ù†Û•Ùƒ Ú†Ù‰Ù‚Ù‰Ø±Ù‰Ø´
      Swal.fire({
        title: 'ğŸ‰ ØªØ§Ù„Ù„Ø§Ù†ØºØ§Ù† Ø³Û‡Ø¦Ø§Ù„',
        html: `
            <div class="text-right p-2">
                <h3 class="text-xl font-bold text-sky-800 mb-4 leading-relaxed">${selected.q}</h3>

                <button id="showAnswerBtn" class="w-full mb-3 px-4 py-2 bg-emerald-100 text-emerald-700 rounded hover:bg-emerald-200 transition font-bold border border-emerald-200 flex justify-center items-center gap-2">
                    <i data-feather="eye"></i> Ø¬Ø§Û‹Ø§Ø¨Ù‰Ù†Ù‰ ÙƒÛ†Ø±Ø³Û•Øª
                </button>

                <div id="answerContent" class="answer-box text-lg">
                    <strong>Ø¬Ø§Û‹Ø§Ø¨:</strong><br/>
                    ${selected.a || 'Ø¨Û‡ Ø³Û‡Ø¦Ø§Ù„Ù†Ù‰Ú­ Ø¬Ø§Û‹Ø§Ø¨Ù‰ ÙƒÙ‰Ø±Ú¯ÛˆØ²ÛˆÙ„Ù…Ù‰Ú¯Û•Ù†'}
                </div>
            </div>
          `,
        showCancelButton: true,
        showDenyButton: true,
        confirmButtonText: 'Ø³Û‡Ø¦Ø§Ù„Ù†Ù‰ Ú†Ù‰Ù‚Ù‰Ø±Ù‰Û‹Û•Øª',
        denyButtonText: 'Ø³Û‡Ø¦Ø§Ù„ Ù‚ÛÙ¾ Ù‚Ø§Ù„Ø³Û‡Ù†',
        cancelButtonText: 'ØªØ§Ù‚Ø§Ø´',
        confirmButtonColor: '#ef4444', // Red
        denyButtonColor: '#3b82f6',    // Blue
        cancelButtonColor: '#9ca3af',  // Gray
        customClass: {
          popup: 'font-arabic',
          title: 'text-2xl text-sky-600'
        },
        didOpen: () => {
          // ÙƒÛ†Ø²Ù†Û•Ùƒ Ø¦ÛÚ†Ù‰Ù„ØºØ§Ù†Ø¯Ø§ Ø¬Ø§Û‹Ø§Ø¨ ÙƒÛ‡Ù†Û‡Ù¾ÙƒÙ‰Ø³Ù‰ØºØ§ Ú¾Û•Ø±Ù‰ÙƒÛ•Øª Ù‚ÙˆØ´Û‡Ø´
          const btn = document.getElementById('showAnswerBtn');
          const content = document.getElementById('answerContent');
          feather.replace(); // Ikonlarni yangilash

          btn.addEventListener('click', () => {
            content.style.display = 'block';
            btn.style.display = 'none';
          });
        }
      }).then((result) => {
        if (result.isConfirmed) {
          // Ø³Û‡Ø¦Ø§Ù„Ù†Ù‰ Ø¦Û†Ú†ÛˆØ±ÛˆØ´
          questions.splice(index, 1);
          updateQuestionList();
          drawWheel();
          saveQuestionsToLocalStorage();
          Swal.fire('Ø¦Û†Ú†ÛˆØ±ÛˆÙ„Ø¯Ù‰', 'Ø³Û‡Ø¦Ø§Ù„ ØªÙ‰Ø²Ù‰Ù…Ù„Ù‰ÙƒØªÙ‰Ù† Ú†Ù‰Ù‚Ù‰Ø±Ù‰Û‹ÛØªÙ‰Ù„Ø¯Ù‰', 'success');
        } else if (result.isDenied) {
          // Ø³Û‡Ø¦Ø§Ù„ Ø³Ø§Ù‚Ù„Ø§Ù¾ Ù‚ÛÙ„Ù‰Ù†Ø¯Ù‰
          Swal.fire('Ø³Ø§Ù‚Ù„Ø§Ù†Ø¯Ù‰', 'Ø³Û‡Ø¦Ø§Ù„ ØªÙ‰Ø²Ù‰Ù…Ù„Ù‰ÙƒØªÛ• Ø³Ø§Ù‚Ù„Ø§Ù¾ Ù‚ÛÙ„Ù‰Ù†Ø¯Ù‰', 'info');
        }
      });
    }, 500);
  }

  function easeOut(t, b, c, d) {
    t /= d;
    t--;
    return c * (t * t * t + 1) + b;
  }

  // JSON Ø¯Ù‰Ù† Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ ÙŠÛˆÙƒÙ„Û•Ø´
  function loadQuestionsFromJSON() {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = '.json';

    input.onchange = e => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = event => {
        try {
          const jsonData = JSON.parse(event.target.result);
          if (Array.isArray(jsonData.questions)) {
            let addedCount = 0;
            jsonData.questions.forEach(item => {
              // Ù…Ø§Ø³Ù„Ù‰Ø´Ù‰Ø´Ú†Ø§Ù†Ù„Ù‰Ù‚ ØªÛ•ÙƒØ´ÛˆØ±ÛˆØ´ (Object ÙŠØ§ÙƒÙ‰ String)
              let newItem = {};
              if (typeof item === 'string') {
                newItem = { q: item, a: '' };
              } else {
                newItem = { q: item.q || '', a: item.a || '' };
              }

              if (newItem.q) {
                questions.push(newItem);
                addedCount++;
              }
            });

            updateQuestionList();
            drawWheel();
            saveQuestionsToLocalStorage();

            Swal.fire({
              title: 'Ù…Û‡Û‹Û•Ù¾Ù¾Ù‰Ù‚Ù‰ÙŠÛ•ØªÙ„Ù‰Ùƒ!',
              text: `${addedCount} Ø³Û‡Ø¦Ø§Ù„ Ù‚ÙˆØ´Û‡Ù„Ø¯Ù‰`,
              icon: 'success',
              confirmButtonText: 'Ø¬Û•Ø²Ù…Ù„Û•Ø´'
            });
          } else {
            throw new Error('JSON Ù‚Û‡Ø±Û‡Ù„Ù…Ù‰Ø³Ù‰ ØªÙˆØºØ±Ø§ Ø¦Û•Ù…Û•Ø³');
          }
        } catch (error) {
          Swal.fire({
            title: 'Ø®Ø§ØªØ§Ù„Ù‰Ù‚!',
            text: 'JSON Ú¾Û†Ø¬Ø¬Ù‰ØªÙ‰Ù†Ù‰ Ø¦ÙˆÙ‚Û‡Ø´ØªØ§ Ø®Ø§ØªØ§Ù„Ù‰Ù‚',
            icon: 'error'
          });
        }
      };
      reader.readAsText(file);
    };

    input.click();
  }

  // Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ JSON Ú¾Û†Ø¬Ø¬Ù‰ØªÙ‰Ú¯Û• Ø³Ø§Ù‚Ù„Ø§Ø´
  function saveQuestionsToJSON() {
    if (questions.length === 0) {
      Swal.fire('Ø¦Û•Ø³ÙƒÛ•Ø±ØªÙ‰Ø´', 'Ø³Ø§Ù‚Ù„Ø§Ø´ Ø¦ÛˆÚ†ÛˆÙ† Ø³Û‡Ø¦Ø§Ù„ ÙŠÙˆÙ‚', 'warning');
      return;
    }

    const data = {
      version: "2.0",
      createdAt: new Date().toISOString(),
      questions: questions
    };

    const jsonString = JSON.stringify(data, null, 2);
    const blob = new Blob([jsonString], { type: 'application/json' });
    const url = URL.createObjectURL(blob);

    const a = document.createElement('a');
    a.href = url;
    a.download = `Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±_${new Date().toISOString().slice(0, 10)}.json`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  // Ø³Û‡Ø¦Ø§Ù„Ù„Ø§Ø±Ù†Ù‰ ÙŠÛ•Ø±Ù„Ù‰Ùƒ Ø³Ø§Ù‚Ù„Ø§Ø´ (LocalStorage)
  function saveQuestionsToLocalStorage() {
    localStorage.setItem('savedQuestions_v2', JSON.stringify(questions));
  }

  // Initialize
  loadInitialQuestions();

  // Make responsive
  window.addEventListener('resize', () => {
    if (window.innerWidth < 500) {
      canvas.width = 300;
      canvas.height = 300;
    } else {
      canvas.width = 500;
      canvas.height = 500;
    }
    drawWheel();
  });
</script>
</body>
</html>
